<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="description" content="Enjoy a free AI-powered multiplayer snake game with skins and chat. Play online with friends now!">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="/output.css" rel="stylesheet">
    <script src="/js/fontawesome.js"></script>
    <title>Multiplayer Snake Game Online Free - Play Now!</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap');
        
        body {
            font-family: 'Press Start 2P', cursive;
            background-color: #1a1a2e;
            color: #e94560;
            overflow-x: hidden;
        }
        
        .game-container {
            position: relative;
            margin: 0 auto;
            border: 8px solid #e94560;
            border-radius: 10px;
            box-shadow: 0 0 20px rgba(233, 69, 96, 0.5);
        }
        
        canvas {
            width: 100%;
            height: 100%;
            background-color: #16213e;
            display: block;
        }
        
        .snake-head {
            background-color: #e94560;
            border-radius: 50%;
            box-shadow: 0 0 10px #e94560;
        }
        
        .snake-body {
            background-color: #0f3460;
            border-radius: 30%;
        }
        
        .foods {
            background-color: #f9b208;
            border-radius: 50%;
            animation: pulse 1s infinite;
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.2); }
            100% { transform: scale(1); }
        }
        
        .ad-container {
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            border: 3px solid #e94560;
            border-radius: 10px;
            padding: 10px;
            position: relative;
            overflow: hidden;
        }
        
        .ad-close {
            position: absolute;
            top: 5px;
            right: 5px;
            background: #e94560;
            color: white;
            border: none;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            font-size: 10px;
            cursor: pointer;
        }
        
        .player-tag {
            display: inline-block;
            padding: 2px 8px;
            border-radius: 10px;
            margin-right: 5px;
            font-size: 10px;
        }
        
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }
        
        .modal-content {
            background-color: #16213e;
            padding: 20px;
            border-radius: 10px;
            border: 5px solid #e94560;
            max-width: 500px;
            width: 90%;
            text-align: center;
            max-height: 90vh;
            overflow-y: auto;
        }
        
        .leaderboard-item {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid #0f3460;
        }
        
        .power-up {
            animation: spin 2s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .shop-item {
            transition: transform 0.3s, box-shadow 0.3s;
        }
        
        .shop-item:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 15px rgba(233, 69, 96, 0.3);
        }
        
        .owned-badge {
            position: absolute;
            top: 5px;
            right: 5px;
            background: #38b000;
            color: white;
            padding: 2px 5px;
            border-radius: 3px;
            font-size: 10px;
        }
        
        .chat-message {
            animation: fadeIn 0.3s;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(5px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .typing-indicator {
            display: flex;
            align-items: center;
            padding: 5px 10px;
            color: #a0a0a0;
            font-size: 0.8em;
        }
        
        .typing-dots {
            display: inline-flex;
            align-items: center;
        }
        
        .typing-dot {
            width: 5px;
            height: 5px;
            background-color: #a0a0a0;
            border-radius: 50%;
            margin: 0 2px;
            animation: typingAnimation 1.5s infinite ease-in-out;
        }
        
        .typing-dot:nth-child(1) { animation-delay: 0s; }
        .typing-dot:nth-child(2) { animation-delay: 0.2s; }
        .typing-dot:nth-child(3) { animation-delay: 0.4s; }
        
        @keyframes typingAnimation {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-5px); }
        }
        
        /* æ–°å¢ï¼šå¸¦æ»šåŠ¨æ¡çš„ç©å®¶åˆ—è¡¨ */
        .player-list-container {
            max-height: 300px;
            overflow-y: auto;
            scrollbar-width: thin;
            scrollbar-color: #e94560 #16213e;
        }
        
        .player-list-container::-webkit-scrollbar {
            width: 6px;
        }
        
        .player-list-container::-webkit-scrollbar-track {
            background: #16213e;
        }
        
        .player-list-container::-webkit-scrollbar-thumb {
            background-color: #e94560;
            border-radius: 6px;
        }
    </style>
</head>
<body class="min-h-screen flex flex-col">
    <!-- é¡¶éƒ¨å¯¼èˆªæ  -->
    <nav class="bg-gray-900 text-white p-4 flex justify-between items-center">
        <div class="flex items-center">
            <i class="fas fa-gamepad text-2xl text-red-500 mr-2"></i>
            <h1 class="text-xl font-bold">Multiplayer Snake Game</h1>
        </div>
        <div class="flex items-center space-x-4">
            <div class="flex items-center">
                <i class="fas fa-coins text-yellow-400 mr-1"></i>
                <span id="coins">0</span>
            </div>
            <button id="shop-btn" class="bg-blue-600 hover:bg-blue-700 px-3 py-1 rounded">
                <i class="fas fa-shopping-cart mr-1"></i>Shop
            </button>
            <button id="leaderboard-btn" class="bg-purple-600 hover:bg-purple-700 px-3 py-1 rounded">
                <i class="fas fa-trophy mr-1"></i>Leaderboard
            </button>
        </div>
    </nav>

    <!-- ä¸»å†…å®¹åŒº -->
    <main class="flex-grow container mx-auto px-4 py-8 flex flex-col lg:flex-row">
        <!-- æ¸¸æˆåŒºåŸŸ -->
        <div class="lg:w-3/4 lg:pr-4 mb-8 lg:mb-0">
            <div class="game-container mx-auto">
                <canvas id="gameCanvas" width="800" height="600"></canvas>
            </div>
            
            <!-- æ¸¸æˆæ§åˆ¶ -->
            <div class="mt-4 flex justify-center space-x-4">
                <button id="start-btn" class="bg-green-600 hover:bg-green-700 text-white px-6 py-2 rounded-lg">
                    <i class="fas fa-play mr-2"></i>Start Game
                </button>
                <button id="pause-btn" class="bg-yellow-600 hover:bg-yellow-700 textç™½è‰² px-6 py-2 rounded-lg" disabled>
                    <i class="fas fa-pause mr-2"></i>Pause
                </button>
                <button id="multiplayer-btn" class="bg-blue-600 hover:bg-blue-700 text-white px-6 py-2 rounded-lg">
                    <i class="fas fa-users mr-2"></i>Multiplayer
                </button>
            </div>
            
            
            
            <!-- æ¸¸æˆçŠ¶æ€ -->
            <div class="mt-6 grid grid-cols-1 md:grid-cols-3 gap-4">
                <div class="bg-gray-800 p-4 rounded-lg">
                    <h3 class="text-sm text-gray-400 mb-2">Current Score</h3>
                    <p id="score" class="text-2xl font-bold">0</p>
                </div>
                <div class="bg-gray-800 p-4 rounded-lg">
                    <h3 class="text-sm text-gray-400 mb-2">	High Score</h3>
                    <p id="high-score" class="text-2xl font-bold">0</p>
                </div>
                <div class="bg-gray-800 p-4 rounded-lg">
                    <h3 class="text-sm text-gray-400 mb-2">Online Players
                    </h3>
                    <p id="player-count" class="text-2xl font-bold">1</p>
                </div>
                <div class="bg-gray-800 p-4 rounded-lg">
                    <h3 class="text-sm text-gray-400 mb-2">Current Speed</h3>
                    <p id="speed" class="text-2xl font-bold">150</p>
                </div>
            </div>
        </div>
        
        <!-- ä¾§è¾¹æ  -->
        <div class="lg:w-1/4">
            <!-- å¹¿å‘Šä½1 -->
            <div class="ad-container mb-6">
                <button class="ad-close">&times;</button>
                <h3 class="text-center mb-2 text-sm">Sponsored Ad</h3>
                <div class="flex justify-center">
                    <img src="https://via.placeholder.com/250x100?text=æ¸¸æˆå¹¿å‘Šä½" alt="å¹¿å‘Š" class="rounded">
                </div>
                <p class="text-xs mt-2 text-center">Click the ad to support us</p>
            </div>
            
            <!-- ç©å®¶åˆ—è¡¨ -->
            <div class="bg-gray-800 p-4 rounded-lg mb-6">
                <h3 class="text-sm text-gray-400 mb-3">Player List</h3>
                <div id="player-list" class="player-list-container space-y-2">
                    <div class="flex items-center">
                        <span class="player-tag bg-red-500">You</span>
                        <span>ç©å®¶1</span>
                        <span class="ml-auto text-xs">>0 pts</span>
                    </div>
                </div>
            </div>
            
            <!-- èŠå¤©å®¤ -->
            <div class="bg-gray-800 p-4 rounded-lg mb-6">
                <h3 class="text-sm text-gray-400 mb-3">Game Chatroom</h3>
                <div id="chat-messages" class="h-40 overflow-y-auto mb-3 text-xs space-y-2">
                    <div class="chat-message text-green-400">System: Welcome to Multiplayer Snake Game!</div>
                </div>
                <!-- æ­£åœ¨è¾“å…¥æŒ‡ç¤ºå™¨ -->
                <div id="typing-indicator" class="typing-indicator hidden">
                    <div class="typing-dots">
                        <div class="typing-dot"></div>
                        <div class="typing-dot"></div>
                        <div class="typing-dot"></div>
                    </div>
                    <span class="ml-2">Other players are typing...</span>
                </div>
                <div class="flex">
                    <input type="text" id="chat-input" class="flex-grow bg-gray-700 text-white px-2 py-1 rounded-l text-xs" placeholder="è¾“å…¥æ¶ˆæ¯...">
                    <button id="chat-send" class="bg-blue-600 hover:bg-blue-700 px-3 py-1 rounded-r text-xs">
                        <i class="fas fa-paper-plane"></i>
                    </button>
                </div>
            </div>
            
            <!-- å¹¿å‘Šä½2 -->
            <div class="ad-container">
                <button class="ad-close">&times;</button>
                <h3 class="text-center mb-2 text-sm">Recommended Game</h3>
                <div class="flex justify-center">
                    <img src="https://via.placeholder.com/250x150?text=æ¨èæ¸¸æˆå¹¿å‘Š" alt="å¹¿å‘Š" class="rounded">
                </div>
                <p class="text-xs mt-2 text-center">Click to learn more</p>
            </div>
        </div>
    </main>
    
    <!-- å•†åº—æ¨¡æ€æ¡† -->
    <div id="shop-modal" class="modal">
        <div class="modal-content">
            <h2 class="text-xl mb-6"><i class="fas fa-shopping-cart mr-2"></i>æ¸¸æˆå•†åº—</h2>
            <div class="flex justify-between mb-4">
                <div class="flex items-center">
                    <i class="fas fa-coins text-yellow-400 mr-2"></i>
                    <span id="shop-coins" class="font-bold">0</span> é‡‘å¸
                </div>
                <button id="refresh-shop" class="bg-gray-700 hover:bg-gray-600 px-3 py-1 rounded text-xs">
                    <i class="fas fa-sync-alt mr-1"></i>åˆ·æ–°å•†å“
                </button>
            </div>
            
            <!-- çš®è‚¤ç±»åˆ« -->
            <h3 class="text-left mb-3 border-b border-gray-700 pb-2"><i class="fas fa-paint-brush mr-2"></i>è›‡çš®è‚¤</h3>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
                <div class="bg-gray-800 p-4 rounded-lg relative shop-item">
                    <h3 class="text-sm mb-2">ç»å…¸çº¢è‰²</h3>
                    <div class="w-full h-20 bg-red-600 mb-2 rounded"></div>
                    <p class="text-xs mb-2">ç»å…¸é»˜è®¤çš®è‚¤</p>
                    <button class="bg-green-600 hover:bg-green-700 text-white px-3 py-1 rounded text-xs w-full buy-btn" data-id="skin-classic" data-price="0" data-owned="true">
                        å·²æ‹¥æœ‰
                    </button>
                </div>
                <div class="bg-gray-800 p-4 rounded-lg relative shop-item">
                    <h3 class="text-sm mb-2">ç«ç„°</h3>
                    <div class="w-full h-20 bg-gradient-to-r from-red-500 to-yellow-500 mb-2 rounded"></div>
                    <p class="text-xs mb-2">è®©ä½ çš„è›‡çœ‹èµ·æ¥åƒç«ç„°ä¸€æ ·é…·ç‚«!</p>
                    <button class="bg-yellow-600 hover:bg-yellow-700 text-white px-3 py-1 rounded text-xs w-full buy-btn" data-id="skin-fire" data-price="500">
                        <i class="fas fa-coins mr-1"></i>500é‡‘å¸
                    </button>
                </div>
                <div class="bg-gray-800 p-4 rounded-lg relative shop-item">
                    <h3 class="text-sm mb-2">å½©è™¹</h3>
                    <div class="w-full h-20 bg-gradient-to-r from-red-500 via-yellow-500 to-purple-500 mb-2 rounded"></div>
                    <p class="text-xs mb-2">å½©è™¹è‰²çš„è›‡ï¼Œè®©å…¶ä»–ç©å®¶ç¾¡æ…•!</p>
                    <button class="bg-yellow-600 hover:bg-yellow-700 text-white px-3 py-1 rounded text-xs w-full buy-btn" data-id="skin-rainbow" data-price="800">
                        <i class="fas fa-coins mr-1"></i>800é‡‘å¸
                    </button>
                </div>
                <div class="bg-gray-800 p-4 rounded-lg relative shop-item">
                    <h3 class="text-sm mb-2">å¹½çµ</h3>
                    <div class="w-full h-20 bg-gradient-to-r from-gray-300 to-gray-500 mb-2 rounded"></div>
                    <p class="text-xs mb-2">åŠé€æ˜æ•ˆæœï¼Œè®©å¯¹æ‰‹éš¾ä»¥çœ‹æ¸…ä½ çš„è›‡!</p>
                    <button class="bg-yellow-600 hover:bg-yellow-700 text-white px-3 py-1 rounded text-xs w-full buy-btn" data-id="skin-ghost" data-price="1000">
                        <i class="fas fa-coins mr-1"></i>1000é‡‘å¸
                    </button>
                </div>
            </div>
            
            <!-- é“å…·ç±»åˆ« -->
            <h3 class="text-left mb-3 border-b border-gray-700 pb-2"><i class="fas fa-magic mr-2"></i>æ¸¸æˆé“å…·</h3>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
                <div class="bg-gray-800 p-4 rounded-lg shop-item">
                    <h3 class="text-sm mb-2">åŠ é€Ÿé“å…·</h3>
                    <div class="w-full h-20 bg-blue-500 flex items-center justify-center mb-2 rounded">
                        <i class="fas fa-bolt text-3xl"></i>
                    </div>
                    <p class="text-xs mb-2">æ¸¸æˆå¼€å§‹æ—¶è·å¾—10ç§’åŠ é€Ÿæ•ˆæœ</p>
                    <div class="flex items-center">
                        <button class="bg-yellow-600 hover:bg-yellow-700 text-white px-3 py-1 rounded text-xs w-full buy-btn" data-id="powerup-speed" data-price="300">
                            <i class="fas fa-coins mr-1"></i>300é‡‘å¸
                        </button>
                        <span class="ml-2 text-xs text-gray-400">x<span id="powerup-speed-count">0</span></span>
                    </div>
                </div>
                <div class="bg-gray-808 p-4 rounded-lg shop-item">
                    <h3 class="text-sm mb-2">æŠ¤ç›¾é“å…·</h3>
                    <div class="w-full h-20 bg-green-500 flex items-center justify-center mb-2 rounded">
                        <i class="fas fa-shield-alt text-3xl"></i>
                    </div>
                    <p class="text-xs mb-2">å…ç–«ä¸€æ¬¡ç¢°æ’ä¼¤å®³</p>
                    <div class="flex items-center">
                        <button class="bg-yellow-600 hover:bg-yellow-700 text-white px-3 py-1 rounded text-xs w-full buy-btn" data-id="powerup-shield" data-price="400">
                            <i class="fas fa-coins mr-1"></i>400é‡‘å¸
                        </button>
                        <span class="ml-2 text-xs text-gray-400">x<span id="powerup-shield-count">0</span></span>
                    </div>
                </div>
                <div class="bg-gray-800 p-4 rounded-lg shop-item">
                    <h3 class="text-sm mb-2">åŒå€åˆ†æ•°</h3>
                    <div class="w-full h-20 bg-purple-500 flex items-center justify-center mb-2 rounded">
                        <i class="fas fa-star text-3xl"></i>
                    </div>
                    <p class="text-xs mb-2">30ç§’å†…è·å¾—åŒå€åˆ†æ•°</p>
                    <div class="flex items-center">
                        <button class="bg-yellow-600 hover:bg-yellow-700 text-white px-3 py-1 rounded text-xs w-full buy-btn" data-id="powerup-double" data-price="600">
                            <i class="fas fa-coins mr-1"></i>600é‡‘å¸
                        </button>
                        <span class="ml-2 text-xs text-gray-400">x<span id="powerup-double-count">0</span></span>
                    </div>
                </div>
                <div class="bg-gray-800 p-4 rounded-lg shop-item">
                    <h3 class="text-sm mb-2">è¿·ä½ è›‡</h3>
                    <div class="w-full h-20 bg-pink-500 flex items-center justify-center mb-2 rounded">
                        <i class="fas fa-compress text-3xl"></i>
                    </div>
                    <p class="text-xs mb-2">ä½ çš„è›‡å˜å¾—æ›´çŸ­æ›´éš¾è¢«å‡»ä¸­</p>
                    <div class="flex items-center">
                        <button class="bg-yellow-600 hover:bg-yellow-700 text-white px-3 py-1 rounded text-xs w-full buy-btn" data-id="powerup-mini" data-price="700">
                            <i class="fas fa-coins mr-1"></i>700é‡‘å¸
                        </button>
                        <span class="ml-2 text-xs text-gray-400">x<span id="powerup-mini-count">0</span></span>
                    </div>
                </div>
            </div>
            
            <!-- å…¶ä»–ç±»åˆ« -->
            <h3 class="text-left mb-3 border-b border-gray-700 pb-2"><i class="fas fa-gem mr-2"></i>ç‰¹æ®Šç‰©å“</h3>
            <div class="grid grid-cols-1 gap-4 mb-6">
                <div class="bg-gray-800 p-4 rounded-lg shop-item">
                    <h3 class="text-sm mb-2">æ”¹åå¡</h3>
                    <div class="w-full h-20 bg-indigo-500 flex items-center justify-center mb-2 rounded">
                        <i class="fas fa-signature text-3xl"></i>
                    </div>
                    <p class="text-xs mb-2">æ›´æ”¹ä½ çš„ç©å®¶åç§°</p>
                    <div class="flex">
                        <input type="text" id="name-input" class="flex-grow bg-gray-700 text-white px-2 py-1 rounded-l text-xs mb-2" placeholder="æ–°åç§°" maxlength="12">
                        <button class="bg-yellow-600 hover:bg-yellow-700 text-white px-3 py-1 rounded-r text-xs buy-btn" data-id="item-name" data-price="1000">
                            <i class="fas fa-coins mr-1"></i>1000é‡‘å¸
                        </button>
                    </div>
                </div>
            </div>
            
            <div class="flex justify-center space-x-4">
                <button id="close-shop" class="bg-red-600 hover:bg-red-700 text-white px-6 py-2 rounded-lg">
                    å…³é—­å•†åº—
                </button>
                <button id="inventory-btn" class="bg-purple-600 hover:bg-purple-700 text-white px-6 py-2 rounded-lg">
                    <i class="fas fa-box-open mr-2"></i>My Items
                </button>
            </div>
        </div>
    </div>
    
    <!-- æ’è¡Œæ¦œæ¨¡æ€æ¡† -->
    <div id="leaderboard-modal" class="modal">
        <div class="modal-content">
            <h2 class="text-xl mb-6"><i class="fas fa-trophy mr-2"></i>æ’è¡Œæ¦œ</h2>
            
            <div class="flex justify-center mb-4">
                <div class="flex space-x-2">
                    <button id="daily-leaderboard" class="bg-blue-600 text-white px-3 py-1 rounded text-xs active-tab">
                        ä»Šæ—¥
                    </button>
                    <button id="weekly-leaderboard" class="bg-gray-700 hover:bg-gray-600 text-white px-3 py-1 rounded text-xs">
                        æœ¬å‘¨
                    </button>
                    <button id="alltime-leaderboard" class="bg-gray-700 hover:bg-gray-600 text-white px-3 py-1 rounded text-xs">
                        å†å²
                    </button>
                </div>
            </div>
            
            <div class="mb-6" id="leaderboard-content">
                <div class="leaderboard-item text-yellow-400">
                    <span>1. è¶…çº§ç©å®¶</span>
                    <span>12500åˆ†</span>
                </div>
                <div class="leaderboard-item text-gray-300">
                    <span>2. è´ªåƒè›‡å¤§å¸ˆ</span>
                    <span>9800åˆ†</span>
                </div>
                <div class="leaderboard-item text-amber-600">
                    <span>3. è›‡ç‹</span>
                    <span>8750åˆ†</span>
                </div>
                <div class="leaderboard-item">
                    <span>4. æ¸¸æˆé«˜æ‰‹</span>
                    <span>7600åˆ†</span>
                </div>
                <div class="leaderboard-item">
                    <span>5. æ–°æ‰‹ç©å®¶</span>
                    <span>5400åˆ†</span>
                </div>
                <div class="leaderboard-item">
                    <span>6. å¿«ä¹åƒè´§</span>
                    <span>4800åˆ†</span>
                </div>
                <div class="leaderboard-item">
                    <span>7. é€Ÿåº¦ä¹‹æ˜Ÿ</span>
                    <span>4200åˆ†</span>
                </div>
                <div class="leaderboard-item">
                    <span>8. èº²é¿é«˜æ‰‹</span>
                    <span>3900åˆ†</span>
                </div>
                <div class="leaderboard-item">
                    <span>9. å¹¸è¿ç©å®¶</span>
                    <span>3600åˆ†</span>
                </div>
                <div class="leaderboard-item">
                    <span>10. ä¼‘é—²ç©å®¶</span>
                    <span>3200åˆ†</span>
                </div>
                <div class="leaderboard-item" id="current-player-rank">
                    <span>25. ä½  (ç©å®¶1)</span>
                    <span>1200åˆ†</span>
                </div>
            </div>
            
            <div class="text-xs text-gray-400 mb-4">
                <p>æ’è¡Œæ¦œæ¯å°æ—¶æ›´æ–°ä¸€æ¬¡ã€‚</p>
                <p>å‰3åç©å®¶å°†è·å¾—é‡‘å¸å¥–åŠ±ã€‚</p>
            </div>
            
            <button id="close-leaderboard" class="bg-red-600 hover:bg-red-700 text-white px-6 py-2 rounded-lg">
                å…³é—­æ’è¡Œæ¦œ
            </button>
        </div>
    </div>
    
    <!-- ç‰©å“æ æ¨¡æ€æ¡† -->
    <div id="inventory-modal" class="modal">
        <div class="modal-content">
            <h2 class="text-xl mb-6"><i class="fas fa-box-open mr-2"></i>æˆ‘çš„ç‰©å“</h2>
            
            <!-- å·²æ‹¥æœ‰çš®è‚¤ -->
            <h3 class="text-left mb-3 border-b border-gray-700 pb-2"><i class="fas fa-paint-brush mr-2"></i>çš®è‚¤</h3>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
                <div class="bg-gray-800 p-4 rounded-lg">
                    <h3 class="text-sm mb-2">ç»å…¸çº¢è‰²</h3>
                    <div class="w-full h-20 bg-red-600 mb-2 rounded"></div>
                    <button class="bg-green-600 hover:bg-green-700 text-white px-3 py-1 rounded text-xs w-full select-skin-btn" data-id="skin-classic" data-selected="true">
                        <i class="fas fa-check mr-1"></i>å·²ä½¿ç”¨
                    </button>
                </div>
            </div>
            
            <!-- å·²æ‹¥æœ‰é“å…· -->
            <h3 class="text-left mb-3 border-b border-gray-700 pb-2"><i class="fas fa-magic mr-2"></i>é“å…·</h3>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
                <div class="bg-gray-800 p-4 rounded-lg">
                    <h3 class="text-sm mb-2">åŠ é€Ÿé“å…·</h3>
                    <div class="w-full h-20 bg-blue-500 flex items-center justify-center mb-2 rounded">
                        <i class="fas fa-bolt text-3xl"></i>
                    </div>
                    <p class="text-xs mb-2">å‰©ä½™æ•°é‡: 0</p>
                    <button class="bg-blue-600 hover:bg-blue-700 text-white px-3 py-1 rounded text-xs w-full use-item-btn" data-id="powerup-speed" disabled>
                        ä½¿ç”¨
                    </button>
                </div>
                <div class="bg-gray-800 p-4 rounded-lg">
                    <h3 class="text-sm mb-2">æŠ¤ç›¾é“å…·</h3>
                    <div class="w-full h-20 bg-green-500 flex items-center justify-center mb-2 rounded">
                        <i class="fas fa-shield-alt text-3xl"></i>
                    </div>
                    <p class="text-xs mb-2">å‰©ä½™æ•°é‡: 0</p>
                    <button class="bg-blue-600 hover:bg-blue-700 text-white px-3 py-1 rounded text-xs w-full use-item-btn" data-id="powerup-shield" disabled>
                        ä½¿ç”¨
                    </button>
                </div>
            </div>
            
            <button id="close-inventory" class="bg-red-600 hover:bg-red-700 text-white px-6 py-2 rounded-lg">
                å…³é—­ç‰©å“æ 
            </button>
        </div>
    </div>
    
    <!-- æ¸¸æˆç»“æŸæ¨¡æ€æ¡† -->
    <div id="game-over-modal" class="modal">
        <div class="modal-content">
            <h2 class="text-xl mb-4 text-red-500">æ¸¸æˆç»“æŸ!</h2>
            <p class="mb-2">ä½ çš„æœ€ç»ˆåˆ†æ•°: <span id="final-score" class="font-bold">0</span></p>
            <p class="mb-4">è·å¾—é‡‘å¸: <span id="earned-coins" class="font-bold text-yellow-400">0</span></p>
            <div class="flex justify-center space-x-4">
                <button id="restart-btn" class="bg-green-600 hover:bg-green-700 text-white px-6 py-2 rounded-lg">
                    <i class="fas fa-redo mr-2"></i>é‡æ–°å¼€å§‹
                </button>
                <button id="share-btn" class="blue-600 hover:bg-blue-700 text-white px-6 py-2 rounded-lg">
                    <i class="fas fa-share-alt mr-2"></i>åˆ†äº«æˆç»©
                </button>
            </div>
            <div class="mt-6 text-xs text-gray-400">
                <p>è§‚çœ‹å¹¿å‘Šå¯ä»¥è·å¾—åŒå€é‡‘å¸å¥–åŠ±!</p>
                <button class="bg-purple-600 hover:bg-purple-700 text-white px-4 py-1 rounded mt-2" id="watch-ad-btn">
                    <i class="fas fa-ad mr-1"></i>è§‚çœ‹å¹¿å‘Š
                </button>
            </div>
        </div>
    </div>
    
    <!-- åº•éƒ¨ä¿¡æ¯ -->
    <footer class="bg-gray-900 text-white text-center py-4 text-xs">
        <p>Â© 2025 Multiplayer Snake Game | Ad revenue supports server maintenance</p>
        <p class="mt-1">Built with HTML5, CSS3, and JavaScript</p>
    </footer>

    <script>
        // æ¸¸æˆå˜é‡
const canvas = document.getElementById('gameCanvas');
const ctx = canvas.getContext('2d');
const gridSize = 20;
const tileCount = canvas.width / gridSize;
const MAX_PLAYERS = 50;
let snake = [];
let foods = [];
let powerUps = [];
let direction = 'right';
let nextDirection = 'right';
let gameRunning = false;
let gamePaused = false;
let score = 0;
let highScore = localStorage.getItem('snakeHighScore') || 0;
let coins = parseInt(localStorage.getItem('snakeCoins')) || 0;
let gameSpeed = 150;
let lastTime = 0;
let isMultiplayer = false;
let players = {};
let playerId = null;
let playerName = 'ç©å®¶' + Math.floor(Math.random() * 1000);
let inventory = JSON.parse(localStorage.getItem('snakeInventory') || '{"skins":["skin-classic"],"items":{},"selectedSkin":"skin-classic"}');
let socket = null;
let roomId = 'default';
let isTyping = false;
let chatActivity = {};
let snakeHeadColor = '#e94560';
let snakeBodyColor = '#0f3460';

// WebSocket è¿æ¥
function connectToServer(newRoomId) {
    roomId = newRoomId;
    socket = new WebSocket(`wss://snake-game-ws.onrender.com?room=${roomId}`);

    socket.onopen = () => {
        addChatMessage('ç³»ç»Ÿ', `å·²è¿æ¥åˆ°æˆ¿é—´ ${roomId}`);
        sendPlayerData();
    };

    socket.onmessage = (event) => {
        const data = JSON.parse(event.data);
        if (data.type === 'init') {
            playerId = data.playerId;
            roomId = data.roomId;
            players = data.data.players;
            foods = Array.isArray(data.data.foods) ? data.data.foods : [];
            powerUps = Array.isArray(data.data.powerUps) ? data.data.powerUps : [];
            updatePlayerList();
            drawGame();
        } else if (data.type === 'players') {
            players = data.data;
            updatePlayerList();
            drawGame();
        } else if (data.type === 'chat') {
            addChatMessage(data.sender, data.message);
        } else if (data.type === 'foods') {
            foods = Array.isArray(data.data) ? data.data : [];
        } else if (data.type === 'powerUps') {
            powerUps = Array.isArray(data.data) ? data.data : [];
        }
    };

    socket.onclose = () => {
        addChatMessage('ç³»ç»Ÿ', 'ä¸æœåŠ¡å™¨æ–­å¼€è¿æ¥ï¼Œæ­£åœ¨å°è¯•é‡è¿...');
        isMultiplayer = false;
        document.getElementById('multiplayer-btn').innerHTML = '<i class="fas fa-users mr-2"></i>å¤šäººæ¨¡å¼';
        document.getElementById('multiplayer-btn').classList.remove('bg-purple-600');
        document.getElementById('multiplayer-btn').classList.add('bg-blue-600');
        players = {};
        updatePlayerList();

        setTimeout(() => {
            if (isMultiplayer) {
                addChatMessage('ç³»ç»Ÿ', 'æ­£åœ¨é‡è¿...');
                connectToServer(roomId);
            }
        }, 5000);
    };

    socket.onerror = (error) => {
        console.error('WebSocket error:', error);
        addChatMessage('ç³»ç»Ÿ', 'è¿æ¥æœåŠ¡å™¨æ—¶å‘ç”Ÿé”™è¯¯');
    };
}

// åˆå§‹åŒ–æ¸¸æˆ
function initGame() {
    snake = [];
    for (let i = 3; i >= 0; i--) {
        snake.push({ x: i, y: 0 });
    }
    
    direction = 'right';
    nextDirection = 'right';
    score = 0;
    updateScore();
    
    applySelectedSkin();

    if (isMultiplayer) {
        sendPlayerData();
    }
}

// ç”Ÿæˆé£Ÿç‰©
function spawnFood() {
    const newFood = {
        x: Math.floor(Math.random() * tileCount),
        y: Math.floor(Math.random() * tileCount),
        hasAd: Math.random() < 0.5
    };
    foods.push(newFood);
}

// æœ¬åœ°ç”Ÿæˆé“å…·ï¼ˆå•äººæ¨¡å¼ï¼‰
function spawnPowerUp() {
    if (Math.random() < 0.3) {
        const newPowerUp = {
            x: Math.floor(Math.random() * tileCount),
            y: Math.floor(Math.random() * tileCount),
            type: Math.random() < 0.5 ? 'speed' : 'shield'
        };
        powerUps = [newPowerUp];
    } else {
        powerUps = [];
    }
}

// æ¸¸æˆä¸»å¾ªç¯
function gameUpdate() {
    if (!gameRunning || gamePaused) return;

    let head = { x: snake[0].x, y: snake[0].y };

    switch (direction) {
        case 'up':
            head.y--;
            break;
        case 'down':
            head.y++;
            break;
        case 'left':
            head.x--;
            break;
        case 'right':
            head.x++;
            break;
    }

    if (head.x < 0 || head.x >= tileCount || head.y < 0 || head.y >= tileCount) {
        gameOver();
        return;
    }

    for (let i = 0; i < snake.length; i++) {
        if (head.x === snake[i].x && head.y === snake[i].y) {
            gameOver();
            return;
        }
    }

    if (isMultiplayer) {
        for (let id in players) {
            if (id !== playerId && players[id].snake) {
                for (let segment of players[id].snake) {
                    if (head.x === segment.x && head.y === segment.y) {
                        gameOver();
                        return;
                    }
                }
            }
        }
    }

    let foodEaten = false;
    for (let i = 0; i < foods.length; i++) {
        if (head.x === foods[i].x && head.y === foods[i].y) {
            score += 10;
            if (foods[i].hasAd) {
                score += 5;
                coins += 5;
                updateCoins();
                addChatMessage('ç³»ç»Ÿ', 'è·å¾—å¹¿å‘Šå¥–åŠ±: +5åˆ†å’Œ+5é‡‘å¸!');
            }
            foodEaten = true;
            if (isMultiplayer) {
                socket.send(JSON.stringify({ type: 'foodEaten', x: foods[i].x, y: foods[i].y }));
            } else {
                foods.splice(i, 1);
                spawnFood();
            }
            break;
        }
    }

    let powerUpEaten = false;
    if (Array.isArray(powerUps)) {
        for (let i = 0; i < powerUps.length; i++) {
            if (head.x === powerUps[i].x && head.y === powerUps[i].y) {
                if (powerUps[i].type === 'speed') {
                    gameSpeed = Math.max(50, gameSpeed - 20);
                    setTimeout(() => gameSpeed = 150, 10000);
                } else if (powerUps[i].type === 'shield') {
                    // è¿™é‡Œå¯ä»¥æ·»åŠ æŠ¤ç›¾æ•ˆæœ
                }
                powerUpEaten = true;
                if (isMultiplayer) {
                    socket.send(JSON.stringify({ type: 'powerUpEaten', x: powerUps[i].x, y: powerUps[i].y }));
                } else {
                    powerUps.splice(i, 1);
                    spawnPowerUp();
                }
                break;
            }
        }
    }

    if (foodEaten || powerUpEaten) {
        updateScore();
    } else {
        snake.pop();
    }
    snake.unshift(head);
    direction = nextDirection;

    drawGame();
    if (isMultiplayer) sendPlayerData();
}

// ç»˜åˆ¶æ¸¸æˆ
function drawGame() {
    ctx.fillStyle = '#16213e';
    ctx.fillRect(0, 0, canvas.width, canvas.height);

    ctx.strokeStyle = '#0f3460';
    ctx.lineWidth = 0.5;
    for (let i = 0; i < tileCount; i++) {
        ctx.beginPath();
        ctx.moveTo(i * gridSize, 0);
        ctx.lineTo(i * gridSize, canvas.height);
        ctx.stroke();
        
        ctx.beginPath();
        ctx.moveTo(0, i * gridSize);
        ctx.lineTo(canvas.width, i * gridSize);
        ctx.stroke();
    }

    for (let i = 0; i < snake.length; i++) {
        if (i === 0) {
            ctx.fillStyle = snakeHeadColor;
            ctx.beginPath();
            ctx.arc(
                snake[i].x * gridSize + gridSize / 2,
                snake[i].y * gridSize + gridSize / 2,
                gridSize / 2,
                0,
                Math.PI * 2
            );
            ctx.fill();
            
            ctx.fillStyle = 'white';
            let eyeOffsetX = 0, eyeOffsetY = 0;
            switch (direction) {
                case 'up':
                    eyeOffsetX = -3;
                    eyeOffsetY = -3;
                    break;
                case 'down':
                    eyeOffsetX = -3;
                    eyeOffsetY = 3;
                    break;
                case 'left':
                    eyeOffsetX = -3;
                    eyeOffsetY = 0;
                    break;
                case 'right':
                    eyeOffsetX = 3;
                    eyeOffsetY = 0;
                    break;
            }
            
            ctx.beginPath();
            ctx.arc(
                snake[i].x * gridSize + gridSize / 2 + eyeOffsetX,
                snake[i].y * gridSize + gridSize / 2 + eyeOffsetY,
                3,
                0,
                Math.PI * 2
            );
            ctx.fill();
        } else {
            ctx.fillStyle = snakeBodyColor;
            ctx.fillRect(
                snake[i].x * gridSize + 2,
                snake[i].y * gridSize + 2,
                gridSize - 4,
                gridSize - 4
            );
        }
    }

    for (let food of foods) {
        ctx.fillStyle = '#f9b208';
        ctx.beginPath();
        ctx.arc(
            food.x * gridSize + gridSize / 2,
            food.y * gridSize + gridSize / 2,
            gridSize / 2 - 2,
            0,
            Math.PI * 2
        );
        ctx.fill();

        if (food.hasAd) {
            ctx.fillStyle = 'white';
            ctx.font = '10px Arial';
            ctx.textAlign = 'center';
            ctx.fillText('å¹¿å‘Š', food.x * gridSize + gridSize / 2, food.y * gridSize + gridSize / 2 + 4);
        }
    }

    if (Array.isArray(powerUps)) {
        for (let powerUp of powerUps) {
            ctx.fillStyle = powerUp.type === 'speed' ? '#00b4d8' : '#38b000';
            ctx.beginPath();
            ctx.arc(
                powerUp.x * gridSize + gridSize / 2,
                powerUp.y * gridSize + gridSize / 2,
                gridSize / 2 - 2,
                0,
                Math.PI * 2
            );
            ctx.fill();
            
            ctx.fillStyle = 'white';
            ctx.font = '12px Arial';
            ctx.textAlign = 'center';
            ctx.textBaseline = 'middle';
            ctx.fillText(
                powerUp.type === 'speed' ? 'âš¡' : 'ğŸ›¡ï¸',
                powerUp.x * gridSize + gridSize / 2,
                powerUp.y * gridSize + gridSize / 2
            );
        }
    }

    if (isMultiplayer) {
        for (let id in players) {
            if (id !== playerId && players[id].snake) {
                let otherSnake = players[id].snake;
                let otherColor = players[id].color || '#555';
                
                for (let i = 0; i < otherSnake.length; i++) {
                    if (i === 0) {
                        ctx.fillStyle = otherColor;
                        ctx.beginPath();
                        ctx.arc(
                            otherSnake[i].x * gridSize + gridSize / 2,
                            otherSnake[i].y * gridSize + gridSize / 2,
                            gridSize / 2,
                            0,
                            Math.PI * 2
                        );
                        ctx.fill();
                        
                        if (players[id].name) {
                            ctx.fillStyle = 'white';
                            ctx.font = '10px Arial';
                            ctx.textAlign = 'center';
                            ctx.fillText(
                                players[id].name,
                                otherSnake[i].x * gridSize + gridSize / 2,
                                otherSnake[i].y * gridSize - 5
                            );
                        }
                    } else {
                        ctx.fillStyle = otherColor;
                        ctx.fillRect(
                            otherSnake[i].x * gridSize + 2,
                            otherSnake[i].y * gridSize + 2,
                            gridSize - 4,
                            gridSize - 4
                        );
                    }
                }
            }
        }
    }
}

// æ¸¸æˆå¾ªç¯
function gameLoop(timestamp) {
    if (!gameRunning || gamePaused) return;

    const deltaTime = timestamp - lastTime;
    if (deltaTime >= gameSpeed) {
        gameUpdate();
        lastTime = timestamp;
    }

    requestAnimationFrame(gameLoop);
}

// å¼€å§‹æ¸¸æˆ
function startGame() {
    if (gameRunning) return;

    initGame();
    gameRunning = true;
    gamePaused = false;

    gameSpeed = 150;
    document.getElementById('start-btn').disabled = true;
    document.getElementById('pause-btn').disabled = false;

    lastTime = performance.now();
    requestAnimationFrame(gameLoop);

    if (!isMultiplayer) {
        foods = [];
        powerUps = [];
        spawnFood();
        spawnPowerUp();
    }
}

// æš‚åœæ¸¸æˆ
function pauseGame() {
    if (!gameRunning) return;

    gamePaused = !gamePaused;

    if (gamePaused) {
        document.getElementById('pause-btn').innerHTML = '<i class="fas fa-play mr-2"></i>ç»§ç»­';
    } else {
        lastTime = performance.now();
        requestAnimationFrame(gameLoop);
        document.getElementById('pause-btn').innerHTML = '<i class="fas fa-pause mr-2"></i>æš‚åœ';
    }
}
console.log(`WebSocket server running on ws://0.0.0.0:${port}`);
    </script>
</body>
</html>